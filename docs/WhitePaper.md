# INTMAX のホワイトペーパー翻訳

[ホワイトペーパー](https://eprint.iacr.org/2023/1082.pdf)を頑張って翻訳して内容を理解するのが目標！！

ステートレスな RollUp が他のレイヤー 2 系のプロジェクトと異なるという点を理解する。

ゼロ知識証明を利用した RollUp 分散型アグリゲータ

## イントロ

ブロックチェーンエコシステムが絶えず進化するにつれて、ブロックチェーンの緊急性も高まっています。
スケーリング・ソリューションが急務となっている。
全体的なスループットを向上させるブロックチェーンスケーリングソリューションが急務となっている。レイヤー 2（L2）技術、特にロールアップは、これらの課題を克服するための極めて重要なツールとして登場し、そのため注目を集めています。
これらの課題を克服するための極めて重要なツールとして登場し、大きな注目を集めています。その中でも、ゼロ知識ロールアップ（または ZK ロールアップ）は、そのユニークな機能により大きな期待を集めている。
は、オンチェーンで迅速かつ安価に検証できる単一の証明に多数のトランザクションをバンドルする独自の機能により、大きな可能性を示している。
既存の ZK-rollups は、その計算コストを
既存の ZK-rollups は、計算コストを基礎となるレイヤー 1（L1）ブロックチェーンから引き離すことに成功しているものの、利用者の残高を検証するために必要なデータがすべて
ユーザーの残高を検証するために必要なデータは、すべて L1 上に掲載されなければならないという事実によって制限されている。この
このデータには、典型的なシナリオでは、トランザクションの送信者、トークンのインデックス、金額、受信者が含まれる。
トークンのインデックス、金額、そして各取引の受取人である。
したがって、ロールアップがサポートできる 1 秒あたりのトランザクション数は制限される。

### 1.1 データの可用性

ブロックチェーンの基本的なボトルネックは、データの可用性と呼ばれるものである。データの可用性とは、口座残高のような現在の状態を証明するために、取引データが利用可能である必要があることを意味する。
ブロックチェーンの口座残高のような現在の状態を証明するためには、取引データが利用可能でなければならない。
ブロックチェーンの現在の状態を証明するためには、取引データが利用可能でなければならない。これはレイヤー 1 のブロックチェーンでもロールアップでも問題となる。レイヤー
レイヤー 1 ブロックチェーンは通常、すべての取引データ
ノードがブロックチェーンを有効とみなすためには、すべての取引データが公開されている必要がある。ロールアップ
は、基礎となるブロックチェーンのデータ可用性を活用することでデータ可用性を実現し、すべてのトランザクションデータが L1 にポストされることを要求する（例えば、イーサリアムでは calldata や blob データを使用する）。このデータは大規模なノード間で複製される必要があるため、利用可能なデータ量には限界がある。
ブロックチェーンやロールアップが利用できる 1 秒あたりのトランザクション数が制限される。
ブロックチェーンやロールアップがサポートできる 1 秒あたりのトランザクション数には限界がある。スマート・コントラクト・ブロックチェーンでは
スマート・コントラクト・ブロックチェーンでは完全な取引データを提供する必要があるかもしれないが
単純な支払いトランザクションでは、次のようなコミットメントを利用可能にするだけでよいことが判明した。
ブロック内のトランザクションのセットに対するコミットメント（メルクル木のルートなど）、
コミットメントに署名した送信者のセットとともに、以下のことを確認する必要がある。
コミットメントに署名した送信者の集合とともに利用できるようにすればよい。その後、ユーザーは
ユーザーは、送信したトランザクションの包含証明と、十分なトランザクションの包含証明および ZK 証明を組み合わせることで、自分の残高のゼロ知識証明（ZK 証明）を生成することができる。
と、トランザクションの送信者がオフチェーンで提供する、受信した各トランザクションの十分な残高の ZK 証明とを組み合わせることにより、自身の残高の ZK 証明を生成することができる。我々のロールアップ・デザインはこの方法
を用いることで、既存の代替案と比較してスループットの向上を達成する。加えて、この設計は、リーダー選出やブロック構築者間の協調を必要とせず、並列に起こりうるパーミッションのないブロック構築を可能にする。
を必要としない。ブロック構築者はトランザクションの正当性を検証しないので、完全にステートレスにすることができる、
ブロック構築者はトランザクションの有効性を検証しないので、完全にステートレスで、非常にシンプルで検閲に強い
ロールアップ設計を可能にする。

### 1.2 我々の貢献

Intmax2 は、効率的でステートレスなロールアップ・デザインである：

- 既存のどのロールアップよりも少ないオンチェーンデータを使用し、イーサリアム上で毎秒 7500 トランザクションバッチを上限とする。
  イーサリアム上で毎秒 7500 トランザクション・バッチを上限とする。
  各トランザクションバッチは無制限のトークンを無制限の受信者に転送できる。
  の受信者に転送できる。
- パーミッションレスのブロック生成を提供。
- 従来の ZK ロールアップよりも強力なプライバシー特性を提供します。

## 2 簡略化された設計の説明

このセクションでは、ZK プルーフを使用しない簡略化した設計について説明する。
ZK プルーフを使用しない。この簡略化された設計は低いオンチェーンデータ消費量(トランザクション送信者当たり 4-5 バイト
5 バイト)を実現するが、それ以外は非効率的であり、プライベートでもない。
セクション 4 では、効率とプライバシーを達成するために ZK-proof を設計に追加する。
プライバシーを実現する。

### 2.1 Overview

簡略化されたデザインは、おおよそ次のように機能する。設計の中心にあるのは
プログラム可能なブロックチェーン（イーサリアムなど）上に展開されたロールアップ契約。
ロールアップに資金を預けるには、ユーザーは単に資金を受取人の L2 アドレスとともに
をロールアップ・コントラクトに送るだけである。
コントラクトはそのコントラクト・ストレージに入金を記録する。ロールアップ上で資金を移動するには、L2
口座のサブセットは、まずそのトランザクションを単一のアグリゲータに送信する。
アグリゲータはそのトランザクションをメルクルツリーのリーフに挿入する。次に、アグリゲータは
は各送信者に、その送信者のトランザクションのメルクル・ルートとメルクル・プルーフを送信する。
を送信する。その後、各送信者は公開 BLS 鍵でメルクルルートに署名し
で署名し、この署名をアグリゲータに送り返す。次に、アグリゲータは署名を 1 つの集約された署名に集約し、マルクルルート、集約された署名、およびリストを送信する。
ルート、アグリゲートされた署名、およびアグリゲートされた署名に含まれる 送信者の公開鍵のリストを、アグリゲータに送信する。
をロールアップコントラクトに送る。ロールアップ
その後、ロールアップ・コントラクトは署名を検証し、ルート、署名、送信者リスト
のリストをストレージに追加する。その後、各送信者はトランザクションのマルクル証明を各トランザクション受信者に送信する責任を負う。
をオフチェーンで各取引の受信者に送る責任がある。
送信者がその取引のために十分な残高を持っていたことを証明する、以前のマルクル証明と一緒に。
の残高を証明する。自分の残高を証明するために、各ユーザは以下を追跡する必要がある。
を追跡する必要がある。この
残高証明と呼ばれるこのメルクル証明のコレクションは、ユーザーが L1 に資金を引き出したいときに、ロールアップコントラクトに送られる。
次に、簡略化された設計について詳しく説明する。

2.8 リプレイ攻撃と遅延ブロック公開からの保護
悪意のあるアグリゲーターが行える攻撃には、以下のようなものがある。
がある。攻撃の一種は遅延ブロック発行である。
悪意のあるアグリゲータは、転送ブロックをパブリッシュする前に長い時間待機する、
これはライブ性の問題を引き起こす。第2の攻撃はリプレイ攻撃である。
リプレイ攻撃とは、悪意のあるアグリゲータが同じ転送ブロックを複数回発行することで、送信者の残高を消耗させる攻撃である。
送信者の残高を消耗させる。これらの攻撃に対する防御をプロトコル内で追加する代わりに
イン・プロトコルではなく、アウト・オブ・プロトコルで行うことができる。
ユーザーにアグリゲータを信頼させるために、アグリゲータは以下のような制限を自らに課すことができる。
L1に中継者契約を導入することで、これらの攻撃を禁止する。ユーザーのサブセットがこの
アグリゲーターはまず、転送ブロックの期限を、それほど遠くない将来
を選ぶ。この期限を受け入れたユーザは、この期限をエクストラデータとして、中継契約アドレスをアグリゲータとして、転送プロトコルに入力する。
をアグリゲータとする。転送ブロックを構築した後、アグリゲータはそれをL
を、コントラクトによってホワイトリストに登録されたL1アドレスからリレイヤーコントラクトに送信する（フロントランニング保護のため）。転送ブロックを受信すると、
フィールドが現在時刻より遅くないことを確認してから、転送ブロックをロールアップ契約
に転送する。これにより、ブロック公開の遅延を防ぐことができる。さらに、リレイヤコントラクトは、ロールアップコントラクトに転送した最後の ブロックのタイムスタンプを保存する。
さらに、中継コントラクトは、ロールアップコントラクトに転送した最後の ブロックのタイムスタンプを保存し、新しい各転送ブロックが以下のタイムスタンプ を持つことを検証する。
転送する前に、各転送ブロックのタイムスタンプが最後に転送されたブロックより厳密に大きいことを検証する。
を検証する。これにより、リプレイ攻撃から保護される。

3 データ使用量と圧縮
このセクションでは、我々の設計のスケーラビリティを分析し、さらにスケーラビリティを高めるために圧縮を追加する方法を説明する。
を説明する。スケーラビリティの主なボトルネックは
スケーラビリティの主なボトルネックは転送ブロックのサイズである：
- アグリゲーターのL1アドレス（イーサリアムでは20バイト）
- エクストラデータ文字列（32バイト）
- 認証済みディクショナリー・コミットメント（メルクルツリーであれば32バイト
ルート)
- ブロック内の送信者のサブセットS⊂K2（｜S｜×96バイト（BLS公開鍵のリストとしてエンコードされた場合
BLS公開鍵のリスト)
- 集約された署名(BLS署名の場合は48バイト)
10 E. Rybakken et al.
これにより、｜S｜ × 96 + 132 バイトの転送ブロック・サイズが得られる。これは従来のロールアップよりも小さい。
これは従来のロールアップの場合よりも小さい。
ブロックに含まれる。また、従来のロールアップとは異なり、我々のブロックサイズは送信者数のみに依存し、トランザクション数には依存しない。これは
つまり、送信者は任意の数の受信者とトランザクション・バッチを送信することができる。
の受信者を、転送ブロックのサイズに影響を与えることなく送ることができる。
スケーラビリティをさらに向上させるために、我々が紹介した中継コントラクトを使用して、プロトコ ル外のブロック圧縮を追加することができる。

スケーラビリティをさらに向上させるために、セクション2.8で紹介したリレ ー契約を使用して、プロトコル外のブロック圧縮を追加することができる。
セクション2.8で紹介したリレー契約を使って、プロトコル外のブロック圧縮を追加することができる。
アグリゲータは圧縮された転送ブロックをリレー契約に送る。
を解凍してからロールアップコントラクトに中継する。単純な圧縮アルゴリズム
アルゴリズムは次のように動作する。ユーザーは自分のプ

公開BLS鍵を
をアグリゲータのリレー契約と交換し、短いインクリメンタルIDを受け取る。リレー
契約は、ID を BLS 公開鍵にマップする辞書をストレージに格納する。
そして、アグリゲータが中継契約へ転送ブロックを送信する際、アグリゲータはその短いIDを送信する。
は公開鍵の代わりに送信者の短い ID を送信する。中継契約は
中継契約はその辞書で各IDを検索し、公開鍵で転送ブロックを再構築する。
を公開鍵で再構築してからロールアップ・コントラクトに送信する。IDのサイズは
IDのサイズは、辞書内のIDの総数に依存する。例として
100億アドレス（現在の世界人口より多い）をサポートするためには、各IDは
log2
(109
)≒33ビット≒4.15バイトでなければならない、
となり、ブロックサイズは｜S｜×4.15＋132バイト程度となる。イーサリアムで実装した場合
イーサリアムで実装した場合、1ブロックあたり0.375 MBのデータ[18]を提供し、ブロックは12秒ごと[1]にやってくる。
12秒ごとにブロックが来る[1]。
0.375 × 106 - 132
4.15
≈ 90000
L1ブロックあたりの送信者数、つまり1秒あたりの送信者数は7500人である。この数は
イーサリアムがさらなるスケーリングを追加した場合、この数は増加する。18]によると、ゴールは以下の通りです。
ブロックあたり≈16 MBを達成することで、毎秒≈320000の送信者を可能にする。

4 プライバシーと効率の追加
セクション2で説明した単純化されたデザインはプライバシーに欠けている。
また、残高証明が大規模で検証コストがかかるため（特に引き出し時のオンチェーン）、効率性にも欠ける。本セクションでは
を追加する。
4.1 ロールアップ・コントラクトの状態の変更と
ブロック
まず、ロールアップ・コントラクトを変更し、ロールアップに追加されたすべてのブロッ
ブロックのリストを格納する代わりに、履歴のルートのリストを格納する。

